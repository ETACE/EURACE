<?xml version="1.0" encoding="ISO-8859-1"?>

<xmachine_agent_model>
<name>Consumption_Goods_Market</name>
<author>Eurace</author>
<date></date>

<environment>

<functions>
<file>Firm_Producer_Functions.c</file>
<file>Household_Consumer_Functions.c</file>
<file>Mall_functions.c</file>
</functions>

<datatypes>

<datatype>
<name>portfolio</name>
<desc>Used by households to hold shares</desc>
<var><type>int</type><name>firm_id</name></var>
<var><type>int</type><name>shares</name></var>
</datatype>

<datatype>
<name>consumption_goods_offer</name>
<desc>Used by household and mall to hold consumption goods offers</desc>
<var><type>int</type><name>id</name></var>
<var><type>double</type><name>quality</name></var>
<var><type>double</type><name>price</name></var>
</datatype>

<datatype>
<name>consumption_request</name>
<desc>Used by  mall to hold demand</desc>
<var><type>int</type><name>worker_id</name></var>
<var><type>int</type><name>firm_id</name></var>
<var><type>double</type><name>quantity</name></var>
</datatype>

<datatype>
<name>mall_info</name>
<desc>Used by firm to hold information about sales in malls</desc>
<var><type>int</type><name>mall_id</name></var>
<var><type>double</type><name>critical_stock</name></var>
<var><type>double</type><name>current_stock</name></var>
</datatype>

<datatype>
<name>mall_quality_price_info</name>
<desc>Used by household to hold information about quality and prices of one good offered by mall</desc>
<var><type>int</type><name>mall_id</name></var>
<var><type>int</type><name>firm_id</name></var>
<var><type>int</type><name>mall_region_id</name></var>
<var><type>double</type><name>quality</name></var>
<var><type>double</type><name>price</name></var>
<var><type>int</type><name>available</name></var>
</datatype>

<datatype>
<name>mall_stock</name>
<desc>Used by mall to hold information about current stock</desc>
<var><type>int</type><name>firm_id</name></var>
<var><type>double</type><name>stock</name></var>
<var><type>double</type><name>price</name></var>
<var><type>double</type><name>quality</name></var>
</datatype>

<datatype>
<name>delivery_volume_per_mall</name>
<desc>Used by firm to hold information about delivery volume per mall</desc>
<var><type>int</type><name>mall_id</name></var>
<var><type>double</type><name>quantity</name></var>
<var><type>double</type><name>price</name></var>
<var><type>double</type><name>quality</name></var>
</datatype>

<datatype>
<name>logit_firm_id</name>
<desc>Used by household to stock logits and corresponding firm IDs</desc>
<var><type>double</type><name>logit</name></var>
<var><type>int</type><name>firm_id</name></var>
</datatype>

<datatype>
<name>sales_in_mall</name>
<desc>Used by mall to calculate sales</desc>
<var><type>int</type><name>firm_id</name></var>
<var><type>double</type><name>sales</name></var>
</datatype>

<datatype>
<name>ordered_quantity</name>
<desc>Used by household to stock ordered quantities</desc>
<var><type>int</type><name>firm_id</name></var>
<var><type>double</type><name>quantity</name></var>
<var><type>double</type><name>price</name></var>
</datatype>

<datatype>
<name>received_quantities</name>
<desc>Used by household to stock received quantities</desc>
<var><type>int</type><name>firm_id</name></var>
<var><type>double</type><name>quantity</name></var>
</datatype>

<datatype>
<name>sold_quantities_per_mall</name>
<desc>Used by firm to hold informations about sales </desc>
<var><type>int</type><name>mall_id</name></var>
<var><type>double</type><name>sold_quantity</name></var>
<var><type>int</type><name>stock_empty</name></var>
<var><type>double</type><name>estimated_demand</name></var>
</datatype>

<datatype>
<name>sales_statistics</name>
<desc>Used by firm to store sales in malls of last periods</desc>
<var><type>int</type><name>mall_id</name></var>
<var><type>int</type><name>period</name></var>
<var><type>double</type><name>sales</name></var>
</datatype>

</datatypes>
</environment>

<xmachine>
<name>Firm</name>
<memory>
<var><type>double</type><name>share_net_investments</name></var>
<var><type>double</type><name>mean_wage</name></var>
<var><type>double</type><name>needed_capital_stock</name></var>
<var><type>double</type><name>actual_cap_price</name></var>
<var><type>double</type><name>mean_specific_skills</name></var>
<var><type>double</type><name>planned_production_quantity</name></var>
<var><type>double</type><name>production_quantity</name></var>
<var><type>double</type><name>unit_costs</name></var>
<var><type>double</type><name>production_costs</name></var>
<var><type>double</type><name>revenue_per_day</name></var>
<var><type>double</type><name>technological_frontier</name></var>
<var><type>double</type><name>cum_revenue</name></var>
<var><type>double</type><name>out_of_stock_costs</name></var>
<var><type>sales_statistics_array</type><name>malls_sales_statistics</name></var>
<var><type>double</type><name>quality</name></var>
<var><type>double</type><name>price</name></var>
<var><type>double</type><name>price_last_month</name></var>

<var><type>double</type><name>demand_capital_stock</name></var>
<var><type>double</type><name>planned_production_costs</name></var>
<var><type>double</type><name>adaption_production_volume_due_to_insufficient_finances</name></var>
<var><type>double</type><name>fraction_reserved_for_delayed_payments</name></var>

<var><type>sold_quantities_per_mall_array</type><name>sold_quantities</name></var>
<var><type>double</type><name>total_sold_quantity</name></var>
<var><type>double</type><name>cum_total_sold_quantity</name></var>
<var><type>delivery_volume_per_mall_array</type><name>delivery_volume</name></var>
<var><type>delivery_volume_per_mall_array</type><name>planned_delivery_volume</name></var>
<var><type>mall_info_array</type><name>current_mall_stocks</name></var>
<var><type>double_array</type><name>last_planned_production_quantities</name></var>
<var><type>int</type><name>day_of_month_to_act</name></var>


</memory>
<functions>


<function>
<name>Firm_calc_production_quantity</name>
<current_state>002</current_state>
<next_state>01</next_state>
<condition>Firm_day_of_month_to_act</condition>
<input><messagetype>current_mall_stock_info</messagetype></input>
</function>


<function>
<name>Firm_set_quantities_zero</name>
<current_state>00</current_state>
<next_state>00b</next_state>
<condition>Firm_not_day_of_month_to_act</condition>
</function>

<!-- <function>
<name>Firm_no_production</name>
<current_state>start</current_state>
<next_state>13</next_state>
<condition>not_day_of_month_to_act</condition>
</function> -->

<function><name>Firm_calc_input_demands</name>
<current_state>01</current_state>
<next_state>02</next_state>
<input><messagetype>productivity</messagetype></input>
</function>


<function><name>Firm_calc_production_quantity_2</name>
<current_state>26</current_state>
<next_state>27</next_state>
<condition>Firm_is_external_financial_needs</condition>
</function>

<function><name>Firm_send_goods_to_mall</name>
<current_state>12</current_state>
<next_state>13</next_state>
<output><messagetype>update_mall_stock</messagetype></output>
</function>

<function><name>Firm_calc_revenue</name>
<current_state>13</current_state>
<next_state>13b</next_state>
<input><messagetype>sales</messagetype></input>
</function>

<function><name>Firm_update_specific_skills_of_workers</name>
<current_state>13b</current_state>
<next_state>14</next_state>
<condition>Firm_day_of_month_to_act</condition>
<input><messagetype>specific_skill_update</messagetype></input>
</function>

<function><name>Firm_idle</name>
<current_state>13b</current_state>
<next_state>14</next_state>
<condition>Firm_not_day_of_month_to_act</condition>
</function>

</functions>
</xmachine>

<xmachine>
<name>Household</name>
<memory>
<var><type>double</type><name>budget</name></var>
<var><type>int</type><name>week_of_month</name></var>
<var><type>double</type><name>weekly_budget</name></var>
<var><type>int</type><name>rationed</name></var>
<var><type>int</type><name>mall_completely_sold_out</name></var>
<var><type>ordered_quantity</type><name>order_quantity[2]</name></var>
<var><type>received_quantities</type><name>received_quantity[2]</name></var>
<var><type>int</type><name>day_of_month_to_act</name></var>
<var><type>int</type><name>day_of_week_to_act</name></var>

<var><type>int</type><name>day_of_month_receive_income</name></var>

<var><type>double</type><name>current_productivity_employer</name></var>
<var><type>double</type><name>current_mean_specific_skills_employer</name></var>
</memory>
<functions>


<function><name>Household_idle</name>
<current_state>06</current_state>
<next_state>09</next_state>
<condition>Household_not_day_of_month_receive_income</condition>
</function>




<function><name>Household_receive_wage</name>
<current_state>06</current_state>
<next_state>07</next_state>
<condition>Household_day_of_month_receive_income_employed</condition>
<input><messagetype>wage_payment</messagetype></input>
</function>


<function><name>Household_update_specific_skills</name>
<current_state>07</current_state>
<next_state>08</next_state>
<output><messagetype>specific_skill_update</messagetype></output>
</function>

<function><name>Household_receive_unemployment_benefits</name>
<current_state>06</current_state>
<next_state>08</next_state>
<condition>Household_day_of_month_receive_income_unemployed</condition>
<!--  <input><messagetype>unemployment_benefits</messagetype></input>-->
</function>

<function><name>Household_determine_consumption_budget</name>
<current_state>08</current_state>
<next_state>09</next_state>
</function>




<function><name>Household_receicve_dividends</name>
<current_state>09</current_state>
<next_state>15</next_state>
<condition>Household_not_day_of_week_to_act</condition>
<input><messagetype>dividend_payment</messagetype></input>
<input><messagetype>capital_good_profit_distribution</messagetype></input>
</function>

<function><name>Household_rank_and_buy_goods_1</name>
<current_state>09</current_state>
<next_state>10</next_state>
<input><messagetype>quality_price_info_1</messagetype></input>
<output><messagetype>consumption_request_1</messagetype></output>
<condition>Household_day_of_week_to_act</condition>
</function>





<function><name>Household_receive_goods_read_rationing</name>
<current_state>10</current_state>
<next_state>11</next_state>
<input><messagetype>accepted_consumption_1</messagetype></input>
</function>


<function><name>Household_idle</name>
<current_state>11</current_state>
<next_state>13</next_state>
<condition>Household_not_rationed</condition>
</function>


<function><name>Household_rank_and_buy_goods_2</name>
<current_state>11</current_state>
<next_state>12</next_state>
<condition>Household_rationed</condition>
<input><messagetype>quality_price_info_2</messagetype></input>
<output><messagetype>consumption_request_2</messagetype></output>
</function>

<function><name>Household_receive_goods_read_rationing_2</name>
<current_state>12</current_state>
<next_state>13</next_state>
<input><messagetype>accepted_consumption_2</messagetype></input>
</function>



<function><name>Household_receicve_dividends</name>
<current_state>13</current_state>
<next_state>14</next_state>
<input><messagetype>dividend_payment</messagetype></input>
<input><messagetype>capital_good_profit_distribution</messagetype></input>
</function>


<function><name>Household_handle_leftover_budget</name>
<current_state>14</current_state>
<next_state>15</next_state>
</function>


</functions>
</xmachine>

<xmachine>
<name>Mall</name>
<memory>
<var><type>mall_stock_array</type><name>current_stock</name></var>
<var><type>sales_in_mall_array</type><name>firm_revenues</name></var>
<var><type>double</type><name>total_supply</name></var>
</memory>
<functions>


<function><name>Mall_send_current_stocks</name>
<current_state>start_Mall</current_state>
<next_state>01</next_state>
<output><messagetype>current_mall_stock_info</messagetype></output>
</function>

<function><name>Mall_update_mall_stock</name>
<current_state>01</current_state>
<next_state>02</next_state>
<input><messagetype>update_mall_stock</messagetype></input>
</function>

<function><name>Mall_send_quality_price_info_1</name>
<current_state>02</current_state>
<next_state>03</next_state>
<output><messagetype>quality_price_info_1</messagetype></output>
</function>

<function><name>Mall_update_mall_stocks_sales_rationing_1</name>
<current_state>03</current_state>
<next_state>04</next_state>
<input><messagetype>consumption_request_1</messagetype></input>
<output><messagetype>quality_price_info_2</messagetype></output>
<output><messagetype>accepted_consumption_1</messagetype></output>
</function>

<function><name>Mall_update_mall_stocks_sales_rationing_2</name>
<current_state>04</current_state>
<next_state>05</next_state>
<input><messagetype>consumption_request_2</messagetype></input>
<output><messagetype>accepted_consumption_2</messagetype></output>
</function>

<function><name>Mall_pay_firm</name>
<current_state>05</current_state>
<next_state>end</next_state>
<output><messagetype>sales</messagetype></output>
</function>


</functions>
</xmachine>


<messages>


<message>
<name>wage_payment</name>
<var><type>int</type><name>firm_id</name></var>
<var><type>int</type><name>worker_id</name></var>
<var><type>double</type><name>payment</name></var>
<var><type>double</type><name>productivity</name></var>
<var><type>double</type><name>average_specific_skills</name></var>
<var><type>double</type><name>range</name></var>
<var><type>double</type><name>x</name></var>
<var><type>double</type><name>y</name></var>
<var><type>double</type><name>z</name></var>
</message>

<message>
<name>quality_price_info_1</name>
<var><type>int</type><name>mall_id</name></var>
<var><type>int</type><name>mall_region_id</name></var>
<var><type>int</type><name>firm_id</name></var>
<var><type>double</type><name>quality</name></var>
<var><type>double</type><name>price</name></var>
<var><type>int</type><name>available</name></var>
<var><type>double</type><name>range</name></var>
<var><type>double</type><name>x</name></var>
<var><type>double</type><name>y</name></var>
<var><type>double</type><name>z</name></var>
</message>

<message>
<name>quality_price_info_2</name>
<var><type>int</type><name>mall_id</name></var>
<var><type>int</type><name>mall_region_id</name></var>
<var><type>int</type><name>firm_id</name></var>
<var><type>double</type><name>quality</name></var>
<var><type>double</type><name>price</name></var>
<var><type>int</type><name>available</name></var>
<var><type>double</type><name>range</name></var>
<var><type>double</type><name>x</name></var>
<var><type>double</type><name>y</name></var>
<var><type>double</type><name>z</name></var>
</message>

<message>
<name>update_mall_stock</name>
<var><type>int</type><name>mall_id</name></var>
<var><type>int</type><name>firm_id</name></var>
<var><type>double</type><name>quantity</name></var>
<var><type>double</type><name>quality</name></var>
<var><type>double</type><name>price</name></var>
<var><type>double</type><name>range</name></var>
<var><type>double</type><name>x</name></var>
<var><type>double</type><name>y</name></var>
<var><type>double</type><name>z</name></var>
</message>


<message>
<name>consumption_request_1</name>
<var><type>int</type><name>mall_id</name></var>
<var><type>int</type><name>worker_id</name></var>
<var><type>int</type><name>firm_id</name></var>
<var><type>double</type><name>quantity</name></var>
<var><type>double</type><name>range</name></var>
<var><type>double</type><name>x</name></var>
<var><type>double</type><name>y</name></var>
<var><type>double</type><name>z</name></var>
</message>

<message>
<name>consumption_request_2</name>
<var><type>int</type><name>mall_id</name></var>
<var><type>int</type><name>worker_id</name></var>
<var><type>int</type><name>firm_id</name></var>
<var><type>double</type><name>quantity</name></var>
<var><type>double</type><name>range</name></var>
<var><type>double</type><name>x</name></var>
<var><type>double</type><name>y</name></var>
<var><type>double</type><name>z</name></var>
</message>

<message>
<name>accepted_consumption_1</name>
<var><type>int</type><name>mall_id</name></var>
<var><type>int</type><name>worker_id</name></var>
<var><type>double</type><name>offered_consumption_volume</name></var>
<var><type>int</type><name>rationed</name></var>
<var><type>double</type><name>range</name></var>
<var><type>double</type><name>x</name></var>
<var><type>double</type><name>y</name></var>
<var><type>double</type><name>z</name></var>
</message>

<message>
<name>accepted_consumption_2</name>
<var><type>int</type><name>mall_id</name></var>
<var><type>int</type><name>worker_id</name></var>
<var><type>double</type><name>offered_consumption_volume</name></var>
<var><type>int</type><name>rationed</name></var>
<var><type>double</type><name>range</name></var>
<var><type>double</type><name>x</name></var>
<var><type>double</type><name>y</name></var>
<var><type>double</type><name>z</name></var>
</message>


<message>
<name>sales</name>
<var><type>int</type><name>mall_id</name></var>
<var><type>int</type><name>firm_id</name></var>
<var><type>double</type><name>revenue</name></var>
<var><type>int</type><name>stock_empty</name></var>
<var><type>double</type><name>range</name></var>
<var><type>double</type><name>x</name></var>
<var><type>double</type><name>y</name></var>
<var><type>double</type><name>z</name></var>
</message>


<message>
<name>current_mall_stock_info</name>
<var><type>int</type><name>mall_id</name></var>
<var><type>int</type><name>firm_id</name></var>
<var><type>double</type><name>stock</name></var>
<var><type>double</type><name>range</name></var>
<var><type>double</type><name>x</name></var>
<var><type>double</type><name>y</name></var>
<var><type>double</type><name>z</name></var>
</message>


<message>
<name>specific_skill_update</name>
<var><type>int</type><name>id</name></var>
<var><type>int</type><name>firm_id</name></var>
<var><type>double</type><name>specific_skills</name></var>
<var><type>double</type><name>range</name></var>
<var><type>double</type><name>x</name></var>
<var><type>double</type><name>y</name></var>
<var><type>double</type><name>z</name></var>
</message>


</messages>


</xmachine_agent_model>
