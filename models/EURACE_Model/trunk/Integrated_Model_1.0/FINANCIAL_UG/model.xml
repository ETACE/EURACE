<!DOCTYPE xmodel SYSTEM "http://eurace.cs.bilgi.edu.tr/XMML.dtd">
<xmodel version="2" >
 <name>Financial Market</name>
 <version>Aix, 10/02/2009</version>
 <description>UNICA</description>
 <models/>
 <environment>
  <constants>
   <variable>
    <type>double</type>
    <name>trading_activity</name>
    <description>household choose randomly to trade or not.</description>
   </variable>
   <variable>
    <type>double</type>
    <name>bonds_newissue_discount</name>
    <description></description>
   </variable>
   <variable>
    <type>int</type>
    <name>couponperiodicitynrmonths</name>
    <description>payment coupon period expressed in number of months: typical value is 6 </description>
   </variable>
   <variable>
    <type>double</type>
    <name>fundamental_return_weight_min</name>
    <description>constant value that regulate the minumum value of the fundamental weight:typical value is 0.1</description>
   </variable>
   <variable>
    <type>int</type>
    <name>days_in_month</name>
    <description>number of days in month : typical value is 20</description>
   </variable>
  </constants>
  <functionFiles>
   <file>Order.c</file>
   <file>COrder.c</file>
   <file>Portfolio.c</file>
   <file>Stock.c</file>
   <file>Double.c</file>
   <file>CDouble.c</file>
   <file>Asset.c</file>
   <file>CAsset.c</file>
   <file>Belief.c</file>
   <file>Firm_Financial_Market.c</file>
   <file>Random.c</file>
   <file>Bond.c</file>
   <file>ClearingHouse_Financial_Market.c</file>
   <file>ClearingMechanism.c</file>
   <file>Household_Financial_Market.c</file>
   <file>Government_Financial_Market.c</file>
   <file>Central_Bank_Financial_Market.c</file>
  </functionFiles>
  <timeUnits>
   <timeUnit>
    <name>daily</name>
    <unit>iteration</unit>
    <period>1</period>
   </timeUnit>
   <timeUnit>
    <name>weekly</name>
    <unit>daily</unit>
    <period>5</period>
   </timeUnit>
   <timeUnit>
    <name>monthly</name>
    <unit>weekly</unit>
    <period>4</period>
   </timeUnit>
  </timeUnits>
  <dataTypes>
   <dataType>
    <name>Order</name>
    <description>ADT order </description>
    <variables>
     <variable>
      <type>int</type>
      <name>issuer</name>
      <description></description>
     </variable>
     <variable>
      <type>int</type>
      <name>quantity</name>
      <description></description>
     </variable>
     <variable>
      <type>double</type>
      <name>price</name>
      <description></description>
     </variable>
     <variable>
      <type>int</type>
      <name>assetId</name>
      <description></description>
     </variable>
    </variables>
   </dataType>
   <dataType>
    <name>Belief</name>
    <description>ADT Belief </description>
    <variables>
     <variable>
      <type>int</type>
      <name>asset_id</name>
      <description></description>
     </variable>
     <variable>
      <type>double</type>
      <name>expectedPriceReturns</name>
      <description></description>
     </variable>
     <variable>
      <type>double</type>
      <name>expectedTotalReturns</name>
      <description></description>
     </variable>
     <variable>
      <type>double</type>
      <name>expectedCashFlowYield</name>
      <description></description>
     </variable>
     <variable>
      <type>double</type>
      <name>volatility</name>
      <description></description>
     </variable>
     <variable>
      <type>double</type>
      <name>expectedEarning</name>
      <description></description>
     </variable>
     <variable>
      <type>double</type>
      <name>expectedEarningPayout</name>
      <description></description>
     </variable>
     <variable>
      <type>double</type>
      <name>last_price</name>
      <description></description>
     </variable>
     <variable>
      <type>double</type>
      <name>utility</name>
      <description></description>
     </variable>
    </variables>
   </dataType>
   <dataType>
    <name>Stock</name>
    <description>ADT Stock</description>
    <variables>
     <variable>
      <type>int</type>
      <name>id</name>
      <description></description>
     </variable>
     <variable>
      <type>int</type>
      <name>nrOutStandingShares</name>
      <description></description>
     </variable>
     <variable>
      <type>int</type>
      <name>index</name>
      <description></description>
     </variable>
     <variable>
      <type>double</type>
      <name>prices[100]</name>
      <description></description>
     </variable>
     <variable>
      <type>double</type>
      <name>returns[100]</name>
      <description></description>
     </variable>
    </variables>
   </dataType>
   <dataType>
    <name>Bond</name>
    <description>ADT Bond</description>
    <variables>
     <variable>
      <type>int</type>
      <name>id</name>
      <description></description>
     </variable>
     <variable>
      <type>int</type>
      <name>nr_outstanding</name>
      <description></description>
     </variable>
     <variable>
      <type>int</type>
      <name>quantity</name>
      <description></description>
     </variable>
     <variable>
      <type>double</type>
      <name>face_value</name>
      <description></description>
     </variable>
     <variable>
      <type>double</type>
      <name>nominal_yield</name>
      <description></description>
     </variable>
     <variable>
      <type>int</type>
      <name>maturity_day</name>
      <description></description>
     </variable>
     <variable>
      <type>int</type>
      <name>issue_day</name>
      <description></description>
     </variable>
     <variable>
      <type>double</type>
      <name>yield2maturity</name>
      <description></description>
     </variable>
     <variable>
      <type>double</type>
      <name>prices[100]</name>
      <description></description>
     </variable>
     <variable>
      <type>int</type>
      <name>index</name>
      <description></description>
     </variable>
     <variable>
      <type>double</type>
      <name>returns[100]</name>
      <description></description>
     </variable>
    </variables>
   </dataType>
   <dataType>
    <name>Asset</name>
    <description>ADT Asset owned</description>
    <variables>
     <variable>
      <type>int</type>
      <name>id</name>
      <description></description>
     </variable>
     <variable>
      <type>int</type>
      <name>quantity</name>
      <description></description>
     </variable>
     <variable>
      <type>double</type>
      <name>lastPrice</name>
      <description></description>
     </variable>
    </variables>
   </dataType>
   <dataType>
    <name>ClearingMechanism</name>
    <description>ADT clearing mechanism </description>
    <variables>
     <variable>
      <type>double</type>
      <name>lastPrice</name>
      <description></description>
     </variable>
     <variable>
      <type>int</type>
      <name>quantity</name>
      <description></description>
     </variable>
     <variable>
      <type>Order_array</type>
      <name>sellOrders</name>
      <description></description>
     </variable>
     <variable>
      <type>Order_array</type>
      <name>buyOrders</name>
      <description></description>
     </variable>
     <variable>
      <type>double_array</type>
      <name>prices</name>
      <description></description>
     </variable>
    </variables>
   </dataType>
  </dataTypes>
 </environment>
 <agents>
  <xagent>
   <name>Household</name>
   <description></description>
   <memory>
    <variable>
     <type>double</type>
     <name>risk_free_rate</name>
     <description>Remuneration rate sent by Bank</description>
    </variable>
    <variable>
     <type>double</type>
     <name>wealth</name>
     <description></description>
    </variable>
    <variable>
     <type>Belief_array</type>
     <name>beliefs</name>
     <description></description>
    </variable>
    <variable>
     <type>Order_array</type>
     <name>pendingOrders</name>
     <description></description>
    </variable>
    <variable>
     <type>Asset_array</type>
     <name>assetsowned</name>
     <description></description>
    </variable>
    <variable>
     <type>double_array</type>
     <name>assetWeights</name>
     <description></description>
    </variable>
    <variable>
     <type>double_array</type>
     <name>assetUtilities</name>
     <description></description>
    </variable>
    <variable>
     <type>double</type>
     <name>cash_on_hand</name>
     <description></description>
    </variable>
    <variable>
     <type>int</type>
     <name>forwardWindow</name>
     <description></description>
    </variable>
    <variable>
     <type>int</type>
     <name>backwardWindow</name>
     <description></description>
    </variable>
    <variable>
     <type>int</type>
     <name>bins</name>
     <description></description>
    </variable>
    <variable>
     <type>double</type>
     <name>randomWeight</name>
     <description></description>
    </variable>
    <variable>
     <type>double</type>
     <name>fundamentalWeight</name>
     <description></description>
    </variable>
    <variable>
     <type>double</type>
     <name>chartistWeight</name>
     <description></description>
    </variable>
    <variable>
     <type>int</type>
     <name>holdingPeriodToForwardW</name>
     <description></description>
    </variable>
    <variable>
     <type>double</type>
     <name>lossaversion</name>
     <description></description>
    </variable>
    <variable>
     <type>double</type>
     <name>strategy</name>
     <description></description>
    </variable>
   </memory>
   <functions>
    <function>
     <name>Household_receives_payment_coupons</name>
     <description></description>
     <currentState>Household_Start_Financial_Market_Role</currentState>
     <nextState>Household_received_coupons</nextState>
     <condition>
      <time>
       <period>monthly</period>
       <phase>1</phase>
      </time>
     </condition>
     <inputs>
      <input>
       <messageName>payment_coupons</messageName>
      </input>
     </inputs>
     <outputs/>
    </function>
    <function>
     <name>idle</name>
     <description></description>
     <currentState>Household_Start_Financial_Market_Role</currentState>
     <nextState>Household_received_coupons</nextState>
     <condition>
      <not>
       <time>
        <period>monthly</period>
        <phase>1</phase>
       </time>
      </not>
     </condition>
     <inputs/>
     <outputs/>
    </function>
    <function>
     <name>Household_receive_info_interest_from_bank</name>
     <description></description>
     <currentState>Household_received_coupons</currentState>
     <nextState>REVISE_PORTFOLIO</nextState>
     <inputs>
      <input>
       <messageName>accountInterest</messageName>
      </input>
     </inputs>
     <outputs/>
    </function>
    <function>
     <name>Household_revises_expected_portfolio</name>
     <description>the household revise his expected portfolio that is represented by the pendingOrders variable </description>
     <currentState>REVISE_PORTFOLIO</currentState>
     <nextState>SELECTSTRATEGY</nextState>
     <inputs/>
     <outputs/>
    </function>
    <function>
     <name>Household_select_strategy</name>
     <description></description>
     <currentState>SELECTSTRATEGY</currentState>
     <nextState>CHOOSE_TO_UPDATE_BELIEFS_OR_NOT</nextState>
     <inputs/>
     <outputs/>
    </function>
    <function>
     <name>Household_stock_beliefs_formation</name>
     <description></description>
     <currentState>CHOOSE_TO_UPDATE_BELIEFS_OR_NOT</currentState>
     <nextState>BOND_BELIEF_FORMATION</nextState>
     <condition>
      <lhs>
       <value>a.strategy</value>
      </lhs>
      <op>NEQ</op>
      <rhs>
       <value>0</value>
      </rhs>
     </condition>
     <inputs>
      <input>
       <messageName>info_firm</messageName>
      </input>
     </inputs>
     <outputs/>
    </function>
    <function>
     <name>Household_bond_beliefs_formation</name>
     <description></description>
     <currentState>BOND_BELIEF_FORMATION</currentState>
     <nextState>SEND_ORDERS</nextState>
     <inputs>
      <input>
       <messageName>info_bond</messageName>
      </input>
     </inputs>
     <outputs/>
    </function>
    <function>
     <name>idle</name>
     <description></description>
     <currentState>CHOOSE_TO_UPDATE_BELIEFS_OR_NOT</currentState>
     <nextState>SEND_ORDERS</nextState>
     <condition>
      <lhs>
       <value>a.strategy</value>
      </lhs>
      <op>EQ</op>
      <rhs>
       <value>0</value>
      </rhs>
     </condition>
     <inputs/>
     <outputs/>
    </function>
    <function>
     <name>Household_send_orders</name>
     <description></description>
     <currentState>SEND_ORDERS</currentState>
     <nextState>WAITORDERSTATUS</nextState>
     <inputs/>
     <outputs>
      <output>
       <messageName>order</messageName>
      </output>
     </outputs>
    </function>
    <function>
     <name>Household_update_its_portfolio</name>
     <description></description>
     <currentState>WAITORDERSTATUS</currentState>
     <nextState>Household_Start_Labour_Role</nextState>
     <inputs>
      <input>
       <messageName>order_status</messageName>
       <filter>
        <lhs>
         <value>a.id</value>
        </lhs>
        <op>EQ</op>
        <rhs>
         <value>m.trader_id</value>
        </rhs>
       </filter>
      </input>
     </inputs>
     <outputs/>
    </function>
   </functions>
  </xagent>
  <xagent>
   <name>Clearinghouse</name>
   <description></description>
   <memory>
    <variable>
     <type>Asset_array</type>
     <name>assets</name>
     <description></description>
    </variable>
    <variable>
     <type>ClearingMechanism</type>
     <name>clearingmechanism</name>
     <description></description>
    </variable>
   </memory>
   <functions>
    <function>
     <name>ClearingHouse_receive_info</name>
     <description></description>
     <currentState>start_Clearinghouse</currentState>
     <nextState>RECEIVEDINFOSTOCK</nextState>
     <inputs>
      <input>
       <messageName>info_firm</messageName>
      </input>
      <input>
       <messageName>info_bond</messageName>
      </input>
     </inputs>
     <outputs/>
    </function>
    <function>
     <name>ClearingHouse_receive_orders_and_run</name>
     <description></description>
     <currentState>RECEIVEDINFOSTOCK</currentState>
     <nextState>COMPUTEDPRICES</nextState>
     <inputs>
      <input>
       <messageName>order</messageName>
       <sort><key>asset_id</key><order>descend</order></sort>
      </input>
     </inputs>
     <outputs>
      <output>
       <messageName>order_status</messageName>
      </output>
     </outputs>
    </function>
    <function>
     <name>ClearingHouse_send_asset_information</name>
     <description></description>
     <currentState>COMPUTEDPRICES</currentState>
     <nextState>end_Clearinghouse</nextState>
     <inputs/>
     <outputs>
      <output>
       <messageName>infoAssetCH</messageName>
      </output>
     </outputs>
    </function>
   </functions>
  </xagent>
  <xagent>
   <name>Firm</name>
   <description></description>
   <memory>
    <variable>
     <type>double</type>
     <name>earnings_payout</name>
     <description></description>
    </variable>
    <variable>
     <type>int</type>
     <name>current_shares_outstanding</name>
     <description></description>
    </variable>
    <variable>
     <type>Stock</type>
     <name>stock</name>
     <description></description>
    </variable>
   </memory>
   <functions>
    <function>
     <name>Firm_send_info</name>
     <description></description>
     <currentState>Firm_End_Macro_Data</currentState>
     <nextState>Firm_Start_Producer_Role</nextState>
     <inputs/>
     <outputs>
      <output>
       <messageName>info_firm</messageName>
      </output>
     </outputs>
    </function>
    <function>
     <name>Firm_receive_stock_info</name>
     <description></description>
     <currentState>15</currentState>
     <nextState>16</nextState>
     <inputs>
      <input>
       <messageName>infoAssetCH</messageName>
       <filter>
        <lhs>
         <value>a.id</value>
        </lhs>
        <op>EQ</op>
        <rhs>
         <value>m.asset_id</value>
        </rhs>
       </filter>
      </input>
     </inputs>
     <outputs/>
    </function>
   </functions>
  </xagent>
  <xagent>
   <name>Government</name>
   <description></description>
   <memory>
    <variable>
     <type>Bond</type>
     <name>bond</name>
     <description></description>
    </variable>
    <variable>
     <type>Order</type>
     <name>pending_order</name>
     <description></description>
    </variable>
   </memory>
   <functions>
    <function>
     <name>Government_pays_coupons</name>
     <description></description>
     <currentState>Gov_Start_Bond_Market</currentState>
     <nextState>Gov_rate_upgrade</nextState>
     <condition>
      <time>
       <period>monthly</period>
       <phase>1</phase>
      </time>
     </condition>
     <inputs/>
     <outputs>
      <output>
       <messageName>payment_coupons</messageName>
      </output>
     </outputs>
    </function>
    <function>
     <name>Government_read_policy_rate</name>
     <description>Government reads the policy rate from the CB and updates the bonds yield</description>
     <currentState>Gov_rate_upgrade</currentState>
     <nextState>GOVERNMENT_paid_coupons</nextState>
     <inputs>
      <input>
       <messageName>policy_rate</messageName>
      </input>
     </inputs>
     <outputs/>
    </function>
    <function>
     <name>Government_send_info_bond</name>
     <description></description>
     <currentState>GOVERNMENT_paid_coupons</currentState>
     <nextState>GOVERNMENT_SENT_info_bond</nextState>
     <inputs/>
     <outputs>
      <output>
       <messageName>info_bond</messageName>
      </output>
     </outputs>
    </function>
    <function>
     <name>Government_orders_issuing</name>
     <description></description>
     <currentState>GOVERNMENT_SENT_info_bond</currentState>
     <nextState>GOVERNMENT_SENT_ORDER</nextState>
     <inputs/>
     <outputs>
      <output>
       <messageName>order</messageName>
      </output>
     </outputs>
    </function>
    <function>
     <name>Government_update_its_portfolio</name>
     <description></description>
     <currentState>GOVERNMENT_SENT_ORDER</currentState>
     <nextState>GOVERNMENT_PORTFOLIO_UPDATED</nextState>
     <inputs>
      <input>
       <messageName>order_status</messageName>
       <filter>
        <lhs>
         <value>a.id</value>
        </lhs>
        <op>EQ</op>
        <rhs>
         <value>m.trader_id</value>
        </rhs>
       </filter>
      </input>
     </inputs>
     <outputs/>
    </function>
    <function>
     <name>Government_receive_info_bond</name>
     <description></description>
     <currentState>GOVERNMENT_PORTFOLIO_UPDATED</currentState>
     <nextState>01</nextState>
     <inputs>
      <input>
       <messageName>infoAssetCH</messageName>
       <filter>
        <lhs>
         <value>a.id</value>
        </lhs>
        <op>EQ</op>
        <rhs>
         <value>m.asset_id</value>
        </rhs>
       </filter>
      </input>
     </inputs>
     <outputs/>
    </function>
    <function>
     <name>idle</name>
     <description></description>
     <currentState>Gov_Start_Bond_Market</currentState>
     <nextState>GOVERNMENT_paid_coupons</nextState>
     <condition>
      <not>
       <time>
        <period>monthly</period>
        <phase>1</phase>
       </time>
      </not>
     </condition>
     <inputs/>
     <outputs/>
    </function>
   </functions>
  </xagent>
  <xagent>
   <name>Central_Bank</name>
   <description></description>
   <memory>
    <variable>
     <type>double_array</type>
     <name>new_bonds_last_price</name>
     <description></description>
    </variable>
   <variable>
     <type>int_array</type>
     <name>gov_bonds_holding</name>
     <description></description>
    </variable>
    <variable>
     <type>int_array</type>
     <name>new_bonds_quantity</name>
     <description></description>
    </variable>
    <variable>
     <type>int_array</type>
     <name>new_bonds_gov_id</name>
     <description></description>
    </variable>
   <variable>
     <type>int</type>
     <name>QE_policy</name>
     <description></description>
    </variable>
   </memory>
   <functions>
    <function>
     <name>CB_receives_info_bond</name>
     <description></description>
     <currentState>CB_market_operations</currentState>
     <nextState>CB_FM_role</nextState>
     <inputs>
      <input>
       <messageName>info_bond</messageName>
      </input>
     </inputs>
     <outputs/>
    </function>
    <function>
     <name>CB_issues_orders</name>
     <description></description>
     <currentState>CB_FM_role</currentState>
     <nextState>CB_waiting_for_clearing</nextState>
     <inputs/>
     <outputs>
      <output>
       <messageName>order</messageName>
      </output>
     </outputs>
    </function>
    <function>
     <name>CB_receives_order_status</name>
     <description></description>
     <currentState>CB_waiting_for_clearing</currentState>
     <nextState>CB_financial_operations_end</nextState>
     <inputs>
      <input>
       <messageName>order_status</messageName>
      </input>
     </inputs>
     <outputs/>
    </function>
   </functions>
  </xagent>
 </agents>
 <messages>
  <message>
   <name>order</name>
   <description>order posted by the Household</description>
   <variables>
    <variable>
     <type>int</type>
     <name>trader_id</name>
     <description></description>
    </variable>
    <variable>
     <type>int</type>
     <name>asset_id</name>
     <description></description>
    </variable>
    <variable>
     <type>double</type>
     <name>limit_price</name>
     <description></description>
    </variable>
    <variable>
     <type>int</type>
     <name>quantity</name>
     <description></description>
    </variable>
   </variables>
  </message>
  <message>
   <name>order_status</name>
   <description>order status posted by clearing house</description>
   <variables>
    <variable>
     <type>int</type>
     <name>trader_id</name>
     <description></description>
    </variable>
    <variable>
     <type>int</type>
     <name>asset_id</name>
     <description></description>
    </variable>
    <variable>
     <type>double</type>
     <name>price</name>
     <description></description>
    </variable>
    <variable>
     <type>int</type>
     <name>quantity</name>
     <description></description>
    </variable>
   </variables>
  </message>
  <message>
   <name>infoAssetCH</name>
   <description>message posted by the Clearing House </description>
   <variables>
    <variable>
     <type>int</type>
     <name>asset_id</name>
     <description></description>
    </variable>
    <variable>
     <type>double</type>
     <name>price</name>
     <description></description>
    </variable>
    <variable>
     <type>int</type>
     <name>quantity</name>
     <description></description>
    </variable>
   </variables>
  </message>
  <message>
   <name>info_firm</name>
   <description>message posted by the Firm</description>
   <variables>
    <variable>
     <type>int</type>
     <name>id</name>
     <description></description>
    </variable>
    <variable>
     <type>double</type>
     <name>earnings</name>
     <description></description>
    </variable>
    <variable>
     <type>double</type>
     <name>dividend</name>
     <description></description>
    </variable>
    <variable>
     <type>double</type>
     <name>earnings_payout</name>
     <description></description>
    </variable>
    <variable>
     <type>double</type>
     <name>equity</name>
     <description></description>
    </variable>
    <variable>
     <type>Stock</type>
     <name>stock</name>
     <description></description>
    </variable>
   </variables>
  </message>
  <message>
   <name>info_bond</name>
   <description>message posted by the Government </description>
   <variables>
    <variable>
     <type>Bond</type>
     <name>bond</name>
     <description></description>
    </variable>
   </variables>
  </message>
  <message>
   <name>payment_coupons</name>
   <description>message posted by the Government, announce the payment coupons and it decreases its payment_account </description>
   <variables>
    <variable>
     <type>double</type>
     <name>coupon</name>
     <description></description>
    </variable>
    <variable>
     <type>int</type>
     <name>government_id</name>
     <description>the unitary cost of a coupon</description>
    </variable>
   </variables>
  </message>
 </messages>
</xmodel>
