<!DOCTYPE xmodel SYSTEM "http://eurace.cs.bilgi.edu.tr/XMML.dtd">
<xmodel version="2" >
 <name>Credit_Market</name>
 <version>Aix, 10/02/2009</version>
 <description></description>
 <models/>
 <environment>
  <constants/>
  <functionFiles>
   <file>Bank_Credit_Functions.c</file>
   <file>Firm_Credit_Functions.c</file>
   <file>Central_Bank_Functions.c</file>
  </functionFiles>
  <timeUnits>
   <timeUnit>
    <name>daily</name>
    <unit>iteration</unit>
    <period>1</period>
   </timeUnit>
   <timeUnit>
    <name>weekly</name>
    <unit>daily</unit>
    <period>5</period>
   </timeUnit>
   <timeUnit>
    <name>monthly</name>
    <unit>weekly</unit>
    <period>4</period>
   </timeUnit>
  </timeUnits>
  <dataTypes>
   <dataType>
    <name>potential_lender</name>
    <description>Collecing the name of an active bank found by firm when entering its credit market role</description>
    <variables>
     <variable>
      <type>int</type>
      <name>bank_name</name>
      <description>Name of Bank</description>
     </variable>
     <variable>
      <type>int</type>
      <name>contacted</name>
      <description>if the bank has been contacted (1) or not (0)</description>
     </variable>
    </variables>
   </dataType>
   <dataType>
    <name>account_item</name>
    <description></description>
    <variables>
     <variable>
      <type>int</type>
      <name>id</name>
      <description>id of the account's holder</description>
     </variable>
     <variable>
      <type>double</type>
      <name>payment_account</name>
      <description>value in the account</description>
     </variable>
    </variables>
   </dataType>
  </dataTypes>
 </environment>
 <agents>
  <xagent>
   <name>Firm</name>
   <description></description>
   <memory>
    <variable>
     <type>potential_lender_array</type>
     <name>set_of_lenders</name>
     <description>Array of structs (potential lender) holding names of (found) active banks</description>
    </variable>
    <variable>
     <type>int</type>
     <name>number_of_banks_asked</name>
     <description>Number of banks where the firm has asked for loans</description>
    </variable>
   </memory>
   <functions>
    <function>
     <name>Firm_ask_loan</name>
     <description></description>
     <currentState>Firm_Start_Credit_Role</currentState>
     <nextState>Firm_Credit_02</nextState>
     <condition>
      <lhs>
       <value>a.external_financial_needs</value>
      </lhs>
      <op>GT</op>
      <rhs>
       <value>0.0</value>
      </rhs>
     </condition>
     <inputs>
      <input>
       <messageName>bank_identity</messageName>
      </input>
     </inputs>
     <outputs>
      <output>
       <messageName>loan_request</messageName>
      </output>
     </outputs>
    </function>
    <function>
     <name>Firm_get_loan</name>
     <description></description>
     <currentState>Firm_Credit_02</currentState>
     <nextState>Firm_End_Credit_Role</nextState>
     <inputs>
      <input>
       <messageName>loan_conditions</messageName>
       <filter>
        <lhs>
         <value>a.id</value>
        </lhs>
        <op>EQ</op>
        <rhs>
         <value>m.firm_id</value>
        </rhs>
       </filter>
      </input>
     </inputs>
     <outputs>
      <output>
       <messageName>loan_acceptance</messageName>
      </output>
     </outputs>
    </function>
   </functions>
  </xagent>
  <xagent>
   <name>Bank</name>
   <description></description>
   <memory>
    <variable>
     <type>double</type>
     <name>cash</name>
     <description></description>
    </variable>
    <variable>
     <type>double</type>
     <name>total_credit</name>
     <description></description>
    </variable>
    <variable>
     <type>double</type>
     <name>equity</name>
     <description></description>
    </variable>
    <variable>
     <type>double</type>
     <name>ecb_debt</name>
     <description></description>
    </variable>
    <variable>
     <type>double</type>
     <name>alfa</name>
     <description></description>
    </variable>
    <variable>
     <type>double</type>
     <name>value_at_risk</name>
     <description></description>
    </variable>
    <variable>
     <type>double</type>
     <name>deposits_rate</name>
     <description>rate on deposits</description>
    </variable>
    <variable>
     <type>double</type>
     <name>bank_gamma[2]</name>
     <description></description>
    </variable>
    <variable>
     <type>double</type>
     <name>profits[2]</name>
     <description></description>
    </variable>
    <variable>
     <type>double</type>
     <name>bank_lambda</name>
     <description></description>
    </variable>
    <variable>
     <type>double</type>
     <name>ecb_interest_rate</name>
     <description></description>
    </variable>
    <variable>
     <type>double</type>
     <name>bank_dividend_rate</name>
     <description></description>
    </variable>
    <variable>
     <type>double</type>
     <name>tax_rate_corporate</name>
     <description></description>
    </variable>
    <variable>
     <type>int</type>
     <name>current_shares_outstanding</name>
     <description></description>
    </variable>
    <variable>
     <type>double</type>
     <name>debt_period</name>
     <description></description>
    </variable>
    <variable>
     <type>int</type>
     <name>loan_request_message_found</name>
     <description></description>
    </variable>
    <variable>
     <type>int</type>
     <name>day_of_month_to_act</name>
     <description>Day of the month to act for bank accounting function</description>
    </variable>
    <variable>
     <type>double</type>
     <name>deposits</name>
     <description></description>
    </variable>
    <variable>
     <type>double</type>
     <name>firm_loan_installments</name>
     <description></description>
    </variable>
    <variable>
     <type>double</type>
     <name>firm_interest_payments</name>
     <description></description>
    </variable>
    <variable>
     <type>double</type>
     <name>firm_loan_issues</name>
     <description></description>
    </variable>
    <variable>
     <type>double</type>
     <name>ecb_interest_payment</name>
     <description></description>
    </variable>
    <variable>
     <type>double</type>
     <name>dividend_payment</name>
     <description></description>
    </variable>
    <variable>
     <type>double</type>
     <name>taxes</name>
     <description></description>
    </variable>
    <variable>
     <type>double</type>
     <name>dividend_per_share</name>
     <description></description>
    </variable>
    <variable>
     <type>double</type>
     <name>current_share_price</name>
     <description></description>
    </variable>
   </memory>
   <functions>
    <function>
     <name>Bank_read_policy_rate</name>
     <description>The bank reads policy rate and updated risk free rate</description>
     <currentState>Bank_update_policy_rate</currentState>
     <nextState>Bank_start_credit_market_role</nextState>
     <condition>
      <time>
       <period>monthly</period>
       <phase>1</phase>
      </time>
     </condition>
     <inputs>
      <input>
       <messageName>policy_rate</messageName>
      </input>
     </inputs>
     <outputs/>
    </function>
    <function>
     <name>idle</name>
     <description>The bank does not update risk free rate</description>
     <currentState>Bank_update_policy_rate</currentState>
     <nextState>Bank_start_credit_market_role</nextState>
     <condition>
      <not>
       <time>
        <period>monthly</period>
        <phase>1</phase>
       </time>
      </not>
     </condition>
     <inputs/>
     <outputs/>
    </function>
    <function>
     <name>Bank_communicate_identity</name>
     <description></description>
     <currentState>Bank_start_credit_market_role</currentState>
     <nextState>Bank_01</nextState>
     <inputs/>
     <outputs>
      <output>
       <messageName>bank_identity</messageName>
      </output>
     </outputs>
    </function>
    <function>
     <name>Bank_send_accountInterest</name>
     <description></description>
     <currentState>Bank_01</currentState>
     <nextState>Bank_02</nextState>
     <inputs/>
     <outputs>
      <output>
       <messageName>accountInterest</messageName>
      </output>
     </outputs>
    </function>
    <function>
     <name>Bank_decide_credit_conditions</name>
     <description></description>
     <currentState>Bank_02</currentState>
     <nextState>Bank_03</nextState>
     <inputs>
      <input>
       <messageName>loan_request</messageName>
       <filter>
        <lhs>
         <value>a.id</value>
        </lhs>
        <op>EQ</op>
        <rhs>
         <value>m.bank_id</value>
        </rhs>
       </filter>
      </input>
     </inputs>
     <outputs>
      <output>
       <messageName>loan_conditions</messageName>
      </output>
     </outputs>
    </function>
    <function>
     <name>Bank_give_loan</name>
     <description></description>
     <currentState>Bank_03</currentState>
     <nextState>Bank_04</nextState>
     <inputs>
      <input>
       <messageName>loan_acceptance</messageName>
       <filter>
        <lhs>
         <value>a.id</value>
        </lhs>
        <op>EQ</op>
        <rhs>
         <value>m.bank_id</value>
        </rhs>
       </filter>
      </input>
     </inputs>
     <outputs/>
    </function>
    <function>
     <name>Bank_receive_installment</name>
     <description></description>
     <currentState>Bank_04</currentState>
     <nextState>Bank_05</nextState>
     <inputs>
      <input>
       <messageName>installment</messageName>
       <filter>
        <lhs>
         <value>a.id</value>
        </lhs>
        <op>EQ</op>
        <rhs>
         <value>m.bank_id</value>
        </rhs>
       </filter>
      </input>
      <input>
       <messageName>bankruptcy</messageName>
       <filter>
        <lhs>
         <value>a.id</value>
        </lhs>
        <op>EQ</op>
        <rhs>
         <value>m.bank_id</value>
        </rhs>
       </filter>
      </input>
     </inputs>
     <outputs/>
    </function>
    <function>
     <name>Bank_account_update_deposits</name>
     <description></description>
     <currentState>Bank_05</currentState>
     <nextState>Bank_06</nextState>
     <inputs>
      <input>
       <messageName>bank_account_update</messageName>
       <filter>
        <lhs>
         <value>a.id</value>
        </lhs>
        <op>EQ</op>
        <rhs>
         <value>m.bank_id</value>
        </rhs>
       </filter>
      </input>
     </inputs>
     <outputs>
      <output>
       <messageName>bank_to_central_bank_account_update</messageName>
      </output>
     </outputs>
    </function>
    <function>
     <name>Bank_accounting</name>
     <description></description>
     <currentState>Bank_06</currentState>
     <nextState>end_Bank</nextState>
     <condition>
      <time>
       <period>monthly</period>
       <phase>a.day_of_month_to_act</phase>
      </time>
     </condition>
     <inputs/>
     <outputs>
      <output>
       <messageName>bank_interest_payment</messageName>
      </output>
      <output>
       <messageName>dividend_per_share</messageName>
      </output>
      <output>
       <messageName>tax_payment</messageName>
      </output>
     </outputs>
    </function>
    <function>
     <name>Bank_idle</name>
     <description></description>
     <currentState>Bank_06</currentState>
     <nextState>end_Bank</nextState>
     <condition>
      <not>
       <time>
        <period>monthly</period>
        <phase>a.day_of_month_to_act</phase>
       </time>
      </not>
     </condition>
     <inputs/>
     <outputs/>
    </function>
   </functions>
  </xagent>
  <xagent>
   <name>Central_Bank</name>
   <description></description>
   <memory>
    <variable>
     <type>double</type>
     <name>ecb_interest_rate</name>
     <description>Base rate of the Central Bank</description>
    </variable>
    <variable>
     <type>double</type>
     <name>equity</name>
     <description>The ECB equity is the account to collect the interest payments from the banks and the government bond interest rate payments.&#xd;&#xd;&#xd;&#xd;&#xd;&#xd;&#xd;&#xd;&#xd;&#xd;&#xd;&#xd;&#xd;&#xd;&#xd;&#xd;&#xd;&#xd;&#xd;&#xd;&#xd;&#xd;&#xd;&#xd;&#xd;&#xd;&#xd;&#xd;&#xd;&#xd;&#xd;&#xd;&#xd;&#xd;&#xd;&#xd;&#xd;&#xd;
The equity of ECB is paid out to all governments as dividends, in proportion to their population.</description>
    </variable>
    <variable>
     <type>double</type>
     <name>dividend_payment</name>
     <description>The equity of ECB is paid out to all governments as dividends, in proportion to their population.</description>
    </variable>
    <variable>
     <type>double</type>
     <name>fiat_money_banks</name>
     <description>This is the sum over banks' ECB_debt, on the ECB's balance sheet, here named as a CB liability.</description>
    </variable>
    <variable>
     <type>double</type>
     <name>ecb_deposits</name>
     <description>Total sum of deposits by governments and banks at the ECB.</description>
    </variable>
    <variable>
     <type>account_item_array</type>
     <name>accounts_banks</name>
     <description></description>
    </variable>
    <variable>
     <type>account_item_array</type>
     <name>accounts_govs</name>
     <description></description>
    </variable>
    <variable>
     <type>double</type>
     <name>cash</name>
     <description>CB liquid asset which takes into account interest payments to CB from banks and (in the future) from govs</description>
    </variable>
   </memory>
   <functions>
    <function>
     <name>Central_Bank_read_account_update</name>
     <description></description>
     <currentState>00</currentState>
     <nextState>end_Central_Bank</nextState>
     <inputs>
      <input>
       <messageName>bank_to_central_bank_account_update</messageName>
      </input>
      <input>
       <messageName>gov_to_central_bank_account_update</messageName>
      </input>
      <input>
       <messageName>bank_interest_payment</messageName>
      </input>
     </inputs>
     <outputs/>
    </function>
    <function>
     <name>Central_Bank_monetary_policy</name>
     <description>Central bank implements monetary policy</description>
     <currentState>start_Central_Bank</currentState>
     <nextState>CB_market_operations</nextState>
     <condition>
      <time>
       <period>monthly</period>
       <phase>1</phase>
      </time>
     </condition>
     <inputs>
      <input>
       <messageName>eurostat_send_macrodata</messageName>
      </input>
     </inputs>
     <outputs>
      <output>
       <messageName>policy_rate</messageName>
      </output>
     </outputs>
    </function>
    <function>
     <name>idle</name>
     <description>Central bank does not implement monetary policy</description>
     <currentState>start_Central_Bank</currentState>
     <nextState>CB_market_operations</nextState>
     <condition>
      <not>
       <time>
        <period>monthly</period>
        <phase>1</phase>
       </time>
      </not>
     </condition>
     <inputs/>
     <outputs/>
    </function>
    <function>
     <name>Central_Bank_read_fiat_money_requests</name>
     <description>Function read the requests for fiat money sent by governments.</description>
     <currentState>CB_market_operations</currentState>
     <nextState>00</nextState>
     <inputs>
      <input>
       <messageName>request_fiat_money</messageName>
      </input>
      <input>
       <messageName>issue_bonds_to_ecb</messageName>
      </input>
     </inputs>
     <outputs/>
    </function>
   </functions>
  </xagent>
 </agents>
 <messages>
  <message>
   <name>policy_rate</name>
   <description>Message sent by CB to communicate the policy rate</description>
   <variables>
    <variable>
     <type>double</type>
     <name>policy_rate_value</name>
     <description>rate value</description>
    </variable>
   </variables>
  </message>
  <message>
   <name>bank_identity</name>
   <description>Message added by bank to communicate its existence to firms.</description>
   <variables>
    <variable>
     <type>int</type>
     <name>bank_id</name>
     <description>name of the bank</description>
    </variable>
   </variables>
  </message>
  <message>
   <name>loan_request</name>
   <description>Message added by firm to demand credit with bank_id, with financial info of applying firm.</description>
   <variables>
    <variable>
     <type>int</type>
     <name>firm_id</name>
     <description></description>
    </variable>
    <variable>
     <type>int</type>
     <name>bank_id</name>
     <description></description>
    </variable>
    <variable>
     <type>double</type>
     <name>equity</name>
     <description></description>
    </variable>
    <variable>
     <type>double</type>
     <name>total_debt</name>
     <description></description>
    </variable>
    <variable>
     <type>double</type>
     <name>external_financial_needs</name>
     <description></description>
    </variable>
   </variables>
  </message>
  <message>
   <name>loan_conditions</name>
   <description> Message added by bank to offer credit; contains the interest rate, the amount of offered credit, and the value_at_risk.</description>
   <variables>
    <variable>
     <type>int</type>
     <name>firm_id</name>
     <description></description>
    </variable>
    <variable>
     <type>int</type>
     <name>bank_id</name>
     <description></description>
    </variable>
    <variable>
     <type>double</type>
     <name>proposed_interest_rate</name>
     <description></description>
    </variable>
    <variable>
     <type>double</type>
     <name>amount_offered_credit</name>
     <description></description>
    </variable>
    <variable>
     <type>double</type>
     <name>value_at_risk</name>
     <description></description>
    </variable>
   </variables>
  </message>
  <message>
   <name>loan_acceptance</name>
   <description>Message added by firm to accept a loan with bank_id, for the amount credit_taken and VAR. The bank does not need to know the firm_id.</description>
   <variables>
    <variable>
     <type>int</type>
     <name>bank_id</name>
     <description></description>
    </variable>
    <variable>
     <type>double</type>
     <name>credit_amount_taken</name>
     <description></description>
    </variable>
    <variable>
     <type>double</type>
     <name>loan_total_var</name>
     <description></description>
    </variable>
   </variables>
  </message>
  <message>
   <name>installment</name>
   <description>Message added by firm pays installment and interest to the bank.</description>
   <variables>
    <variable>
     <type>int</type>
     <name>bank_id</name>
     <description></description>
    </variable>
    <variable>
     <type>double</type>
     <name>installment_amount</name>
     <description>installment_amount is 0 in case of bankruptcy, positive in case of No_bankruptcy</description>
    </variable>
    <variable>
     <type>double</type>
     <name>interest_amount</name>
     <description></description>
    </variable>
    <variable>
     <type>double</type>
     <name>var_per_installment</name>
     <description></description>
    </variable>
   </variables>
  </message>
  <message>
   <name>bankruptcy</name>
   <description>Message added by firm to bank to signal bankruptcy.</description>
   <variables>
    <variable>
     <type>int</type>
     <name>firm_id</name>
     <description></description>
    </variable>
    <variable>
     <type>int</type>
     <name>bank_id</name>
     <description></description>
    </variable>
    <variable>
     <type>double</type>
     <name>bad_debt</name>
     <description></description>
    </variable>
    <variable>
     <type>double</type>
     <name>credit_refunded</name>
     <description></description>
    </variable>
    <variable>
     <type>double</type>
     <name>residual_var</name>
     <description></description>
    </variable>
   </variables>
  </message>
  <message>
   <name>bank_interest_payment</name>
   <description>Interests paid by banks to ecb</description>
   <variables>
    <variable>
     <type>double</type>
     <name>bank_interest_amount</name>
     <description></description>
    </variable>
   </variables>
  </message>
  <message>
   <name>accountInterest</name>
   <description>message posted by the Bank </description>
   <variables>
    <variable>
     <type>int</type>
     <name>bank_id</name>
     <description></description>
    </variable>
    <variable>
     <type>double</type>
     <name>interest</name>
     <description></description>
    </variable>
   </variables>
  </message>
 </messages>
</xmodel>
