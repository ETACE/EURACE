<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE xmodel SYSTEM "http://eurace.cs.bilgi.edu.tr/XMML.dtd">
<xmodel version="2">
	
	<name>Financial Market</name>
	<version>Genova</version>
	<description>Mario Locci 010807</description>
	
	<!--***************** Environment values and functions **********************-->
	<environment>
		<dataTypes>
			<dataType>
				<name>Order</name>
				<description>ADT order </description>
				<variables>
					<variable><type>int</type><name>issuer</name>	<description></description></variable>
					<variable><type>int</type><name>quantity</name>	<description></description></variable>
					<variable><type>double</type><name>price</name>	<description></description></variable>
					<variable><type>int</type><name>assetId</name>	<description></description></variable>
				</variables>
			</dataType>
			<dataType>
				<name>Histogram</name>
				<description>ADT Histogram</description>
				<variables>
					<variable><type>double</type><name>prob[30]</name>	<description></description></variable>
					<variable><type>double</type><name>value[30]</name>	<description></description></variable>
					<variable><type>double</type><name>max</name>	<description></description></variable>
					<variable><type>double</type><name>min</name>	<description></description></variable>
					<variable><type>double</type><name>delta</name>	<description></description></variable>
					<variable><type>int</type><name>bins</name>	<description></description></variable>
				</variables>
			</dataType>
			<dataType>
				<name>Belief</name>
				<description>ADT Belief </description>
				<variables>
					<variable><type>double</type><name>expectedPriceReturns</name>	<description></description></variable>
					<variable><type>double</type><name>expectedTotalReturns</name>	<description></description></variable>
					<variable><type>double</type><name>expectedCashFlowYield</name>	<description></description></variable>
					<variable><type>double</type><name>volatility</name><description></description></variable>
					<variable><type>Histogram</type><name>hist</name><description></description></variable>
				</variables>
			</dataType>
			
			<dataType>
				<name>Stock</name>
				<description>ADT Stock</description>
				<variables>
					<variable><type>int</type><name>nrOutStandingShares</name>	<description></description></variable>
					<variable><type>int</type><name>id</name>	<description></description></variable>
					<variable><type>double</type><name>dividendExp</name>	<description></description></variable>
					<variable><type>double</type><name>prices[100]</name>	<description></description></variable>
					<variable><type>double</type><name>returns[100]</name>	<description></description></variable>
				</variables>
			</dataType>
			<dataType>
				<name>Asset</name>
				<description>ADT Asset </description>
				<variables>
					<variable><type>int</type><name>id</name>	<description></description></variable>
					<variable><type>int</type><name>quantity</name>	<description></description></variable>
					<variable><type>double</type><name>lastPrice</name>	<description></description></variable>
				</variables>
			</dataType>
			<dataType>
				<name>Portfolio</name>
				<description>ADT  portfolio </description>
				<variables>
					<!--<variable><type>Asset</type><name>assets</name>	<description></description></variable>-->
					<variable><type>double</type><name>bankAccount</name>	<description></description></variable>
				</variables>
			</dataType>
		</dataTypes>
	</environment>
	
	<!--********************* X-machine Agent - Trader ****************************-->
	<agents>
	<xagent>
		<name>Eurostat</name>
		<description></description>
		<memory>
			<variable><type>int</type><name>id</name><description></description></variable>
			<variable><type>Asset_array</type><name>assets</name><description></description></variable>
			<variable><type>Stock_array</type><name>stocks</name><description></description></variable>
		</memory>
		<functions>
			<function>
				<name>sendAssetInformationEURO</name>
				<description></description>
				<currentState>Start_Eurostat_Financial_Data</currentState>
				<nextState>WAITENDMARKET</nextState>
				<outputs>
					<output><messageName>infoAssetEURO</messageName></output>
				</outputs>
			</function>
			<function>
				<name>receiveAssetInformationEURO</name>
				<description></description>
				<!--<depends><name>sendAssetInformation</name><type>infoAsset</type></depends>-->
				<currentState>WAITENDMARKET</currentState>
				<nextState>End_Eurostat_Financial_Data</nextState>
				<inputs><input><messageName>infoAssetCH</messageName></input></inputs>
			</function>
		</functions>
	</xagent>
	<xagent>
		<name>Household</name>
		<description></description>
		<!--             Variables                -->
		<!-- All variableiables used by Producer are declared here to allocate them in memory -->
		<memory>
			<variable><type>int</type><name>id</name>	<description></description></variable>
			<variable><type>double</type><name>wealth</name>	<description></description></variable>
			<variable><type>Belief_array</type><name>belief</name>	<description></description></variable>
			<variable>
				<type>Portfolio</type>
				<name>portfolio</name>
				<description></description></variable>
			<variable>
				<type>Order_array</type>
				<name>pendingOrders</name>
				<description></description></variable>
			<variable>
				<type>Asset_array</type>
				<name>assetsowned</name>
				<description></description></variable>
			<variable>
				<type>double_array</type>
				<name>assetWeights</name>
				
				<description></description></variable>
			<variable>
				<type>double_array</type>
				<name>assetUtilities</name>
				
				<description></description></variable>
			<variable><type>int</type><name>forwardWindow</name>	<description></description></variable>
			<variable><type>int</type><name>backwordWindow</name>	<description></description></variable>
			<variable><type>int</type><name>binsNumber</name>	<description></description></variable>
			<variable><type>double</type><name>randomWeigth</name>	<description></description></variable>
			<variable><type>double</type><name>fundametalWeigth</name>	<description></description></variable>
			<variable><type>double</type><name>chartistWeigth</name>	<description></description></variable>
			<variable><type>int</type><name>holdingPeriodToForwardW</name>	<description></description></variable>
			
		</memory>
		<!--     Defining functions     -->
		<functions>
			<function>
				<name>receiveAssetInformationEUROSTAT</name>
				<description></description>
				<currentState>START_HOUSEHOLD</currentState>
				<nextState>SELECTSTRATEGY</nextState>
				<inputs>
					<input><messageName>infoAssetEURO</messageName></input>
				</inputs>
			</function>
			<function>
				<name>selectStrategy</name>
				<description></description>
				<currentState>SELECTSTRATEGY</currentState>
				<nextState>WAITORDERSTATUS</nextState>
				<outputs>
					<output><messageName>order</messageName></output>
				</outputs>
			</function>
			<function>
				<name>updateTrader</name>
				<description></description>
				<currentState>WAITORDERSTATUS</currentState>
				<nextState>EXIT_FINANCIAL_MARKET</nextState>
				<inputs>
					<input><messageName>order_status</messageName></input>
				</inputs>
				<outputs>
					<output><messageName>bankAccountUpdate</messageName></output>
				</outputs>
			</function>
		</functions>
	</xagent>
	<!--******************** X-machine Agent - Clearinghouse ***************************-->
	<xagent>
		<name>Clearinghouse</name>
		<description></description>
		<!--      Variables for the Clearinghouse     -->
		
		<memory>
			<variable><type>int</type><name>id</name><description></description></variable>
			<variable><type>Asset_array</type><name>assets</name><description></description></variable>
		</memory>
		<!--        Defining functions                -->
		<functions>
			<function>
				<name>receiveOrdersAndRun</name>
				<description></description>
				<currentState>start_Clearinghouse</currentState>
				<nextState>COMPUTEDPRICES</nextState>
				<inputs><input><messageName>order</messageName></input></inputs>
				<outputs>
					<output><messageName>order_status</messageName></output>
				</outputs>
			</function>
			<function>
				<name>sendAssetInformation</name>
				<description></description>
				<currentState>COMPUTEDPRICES</currentState>
				<nextState>end_Clearinghouse</nextState>
				<outputs>
					<output><messageName>infoAssetCH</messageName></output>
					
				</outputs>
			</function>
		</functions>
	</xagent>
	<!--******************** X-machine Agent - Bank ***************************-->
	<xagent>
		<name>Bank</name>
		<description></description>
		<!--      Variables for the Bank     -->
		
		<memory>
			
			<variable><type>double</type><name>range</name>	<description></description></variable>
			<variable><type>double</type><name>posx</name>	<description></description></variable>
			<variable><type>double</type><name>posy</name>	<description></description></variable>
		</memory>
		<!--        Defining functions                -->
		<functions>
			<function>
				<name>receiveAccountUpdate</name>
				<description></description>
				<currentState>RECEIVEMESS</currentState>
				<nextState>RECEIVEMESS1</nextState>
				<inputs>
					<input>
						<messageName>bankAccountUpdate</messageName>
					</input>
				</inputs>
			</function>
		</functions>
	</xagent>
	</agents>
	
	<!--******** Messages being posted by the agents to communicate *************-->
	<messages>
		<!--          Message posted to load a new value        -->
		<message>
			<name>order</name> 
			<description>order posted by the Trader</description>
			<variables>
				<variable><type>int</type><name>trader_id</name><description></description></variable>
				<variable><type>int</type><name>asset_id</name><description></description></variable>
				<variable><type>double</type><name>limit_price</name>	<description></description></variable>
				<variable><type>int</type><name>quantity</name>	<description></description></variable>
			</variables>
		</message>
		
		<message>
			<name>order_status</name>
			<description>The market is closed</description>
			<variables>
				<variable><type>int</type><name>trader_id</name><description></description></variable>
				<variable><type>int</type><name>asset_id</name>	<description></description></variable>
				<variable><type>double</type><name>price</name>	<description></description></variable>
				<variable><type>int</type><name>quantity</name>	<description></description></variable>
			</variables>
		</message>
		
		<message>
			<name>infoAssetEURO</name>
			<description></description>
			<variables>
				<variable><type>int</type><name>asset_id</name>	<description></description></variable>
				<variable><type>double</type><name>price</name>	<description></description></variable>
				<variable><type>int</type><name>quantity</name>	<description></description></variable>
				
			</variables>
		</message>
		
		<message>
			<name>infoAssetCH</name>
			<description></description>
			<variables>
				<variable><type>int</type><name>asset_id</name>	<description></description></variable>
				<variable><type>double</type><name>price</name>	<description></description></variable>
				<variable><type>int</type><name>quantity</name>	<description></description></variable>
				<variable><type>double</type><name>range</name>	<description></description></variable>
				
			</variables>
		</message>
		
		<message>
			<name>infoFirm</name>
			<description>message posted by the Firm </description>
			<variables>
				<variable><type>int</type><name>id</name>	<description></description></variable>
				<variable><type>double</type><name>earningExp</name>	<description></description></variable>
				<variable><type>double</type><name>earningPayoutExp</name>	<description></description></variable>
				<variable><type>double</type><name>equity</name>	<description></description></variable>
				
			</variables>
		</message>
		
		<message>
			<name>infoStock</name>
			<description>message posted by the Eurostat </description>
			<variables>
				<variable><type>int</type><name>trader_id</name><description></description></variable>
				<variable><type>int</type><name>nrOutStandingShares</name><description></description></variable>
				<variable><type>double</type><name>dividendExp</name><description></description></variable>
				<variable><type>Stock</type><name>stock</name>	<description></description></variable>
	
				
			</variables>
		</message>
		
		<message>
			<name>bankAccountUpdate</name>
			<description>message posted by the Household </description>
			<variables>
				<variable><type>double</type><name>account</name>	<description></description></variable>
				
			</variables>
		</message>
		
	</messages>
	<!--********************** End of Messages **********************************-->
	
</xmodel>
