
<xmachine_agent_model>
<name>Credit_Market</name>
<author>Eurace</author>
<date></date>

<environment>

<functions>
<file>Bank_credit_functions.c</file>
<file>Firm_credit_functions.c</file>
<file>Household_credit_functions.c</file>
</functions>

<datatypes>
</datatypes>
</environment>

<xmachine>
<name>Firm</name>
<memory>
<var><type>int</type><name>id</name></var>
<var><type>double_array</type><name>interest</name></var>
<var><type>double_array</type><name>credit_offer</name></var>
<var><type>int_array</type><name>contacted_bank</name></var>
<var><type>double</type><name>total_debt</name></var>
<var><type>double</type><name>asset</name></var>
<var><type>double</type><name>credit_demand</name></var>
<var><type>double_array</type><name>installment_amount</name></var>
<var><type>int</type><name>installment_number</name></var>
<var><type>int</type><name>loans_number</name></var>
<var><type>double_array</type><name>outstanding_debt</name></var>
<var><type>int_array</type><name>lending_bank_id</name></var>
<var><type>double_array</type><name>interest_amount</name></var>
<var><type>int</type><name>bankruptcy_state</name></var>
<var><type>double</type><name>total_resources</name></var>
<var><type>double_array</type><name>residual_var</name></var>
<var><type>double_array</type><name>var_per_installment</name></var>
<var><type>double_array</type><name>value_at_risk</name></var>
<var><type>double_array</type><name>interest_left</name></var>
<var><type>double</type><name>current_equity</name></var>
<var><type>double</type><name>current_debt</name></var>

</memory>
<functions>

<function>
<name>Firm_ask_loan</name>
<current_state>01</current_state>
<next_state>02</next_state>
<output><messagetype>loan_request</messagetype></output>
</function>

<function>
<name>Firm_get_loan</name>
<current_state>02</current_state>
<next_state>03</next_state>
<input><messagetype>loan_conditions</messagetype></input>
<output><messagetype>loan_acceptance</messagetype></output>
</function>

<function>
<name>Firm_pay_interest_installment</name>
<current_state>03</current_state>
<next_state>04</next_state>
<output><messagetype>installment</messagetype></output>
<output><messagetype>bankruptcy</messagetype></output>
</function>

</functions>
</xmachine>

<xmachine>
<name>Bank</name>
<memory>
<var><type>int</type><name>id</name></var>
<var><type>double</type><name>cash</name></var>
<var><type>double</type><name>total_credit</name></var>
<var><type>double</type><name>equity</name></var>
<var><type>double</type><name>bce_debt</name></var>
<var><type>double</type><name>alfa</name></var>
<var><type>double</type><name>var</name></var>
<var><type>double</type><name>min_interest</name></var>
<var><type>double</type><name>gamma[2]</name></var>
<var><type>double</type><name>profits[2]</name></var>
<var><type>double</type><name>lambda</name></var>
<var><type>double</type><name>bce_interest</name></var>
<var><type>double</type><name>debt_period</name></var>
<var><type>int</type><name>loan_request_message_found</name></var>
</memory>
<functions>


<function>
<name>Bank_decide_credit_conditions</name>
<current_state>Bank_start</current_state>
<next_state>01</next_state>
<input><messagetype>loan_request</messagetype></input>
<output><messagetype>loan_conditions</messagetype></output>
<condition>loan_request==0</condition>
</function>

<function>
<name>Bank_receive_deposits</name>
<current_state>02</current_state>
<next_state>03</next_state>
<input><messagetype>household_deposit</messagetype></input>
</function>

<function>
<name>Bank_return_deposits</name>
<current_state>03</current_state>
<next_state>04</next_state>
<input><messagetype>money_withdraw_request</messagetype></input>
<output><messagetype>withdrawal_allowed</messagetype></output>
</function>

<function>
<name>Bank_receive_installment</name>
<current_state>04</current_state>
<next_state>05</next_state>
<input><messagetype>installment</messagetype></input>
<input><messagetype>bankruptcy</messagetype></input>
</function>

<function>
<name>Bank_give_loan</name>
<current_state>05</current_state>
<next_state>06</next_state>
<input><messagetype>loan_acceptance</messagetype></input>
</function>

</functions>
</xmachine>



<xmachine>
<name>Household</name>
<memory>
<var><type>int</type><name>id</name></var>
<var><type>double</type><name>total_deposit</name></var>
<var><type>int</type><name>bank_account</name></var>
</memory>
<functions>


<function>
<name>Household_put_money</name>
<current_state>01</current_state>
<next_state>02</next_state>
<output><messagetype>household_deposit</messagetype></output>
</function>

<function>
<name>Household_choose_bank</name>
<current_state>02</current_state>
<next_state>03</next_state>
</function>

<function>
<name>Household_withdraw</name>
<current_state>04</current_state>
<next_state>05</next_state>
<input><messagetype>withdrawal_allowed</messagetype></input>
</function>

<function>
<name>Household_withdraw_request</name>
<current_state>03</current_state>
<next_state>04</next_state>
<output><messagetype>money_withdraw_request</messagetype></output>
</function>


</functions>
</xmachine>


<messages>

<message>
<name>loan_request</name>
<note>Added by firm to demand credit; credit request and financial info of applying firm</note>
<var><type>double</type><name>current_equity</name></var>
<var><type>double</type><name>current_debt</name></var>
<var><type>double</type><name>credit_demand</name></var>
<var><type>int</type><name>firm_id</name></var>
<var><type>int</type><name>bank_id</name></var>
</message>

<message>
<name>loan_conditions</name>
<note>Added by bank to offer credit;amount of offered credit and interest rate</note>
<var><type>double</type><name>proposed_interest_rate</name></var>
<var><type>double</type><name>amount_offered_credit</name></var>
<var><type>int</type><name>firm_id</name></var>
<var><type>int</type><name>bank_id</name></var>
<var><type>double</type><name>var</name></var>
</message>

<message>
<name>household_deposit</name>
<note>how much the family deposits</note>
<var><type>double</type><name>money_deposited</name></var>
<var><type>int</type><name>bank_id</name></var>
<var><type>int</type><name>household_id</name></var>
</message>

<message>
<name>money_withdraw_request</name>
<note>how much household wants to withdraw and names</note>
<var><type>double</type><name>money_withdraw_request</name></var>
<var><type>int</type><name>bank_id</name></var>
<var><type>int</type><name>household_id</name></var>
</message>

<message>
<name>loan_acceptance</name>
<note>Added by firm to demand credit: the firm takes the credit offered</note>
<var><type>double</type><name>credit_amount_taken</name></var>
<var><type>int</type><name>bank_id</name></var>
</message>


<message>
<name>installment</name>
<note>firm pays instalment and interest of period</note>
<var><type>double</type><name>installment</name></var>
<var><type>double</type><name>interest</name></var>
<var><type>int</type><name>bank_id</name></var>
<var><type>double</type><name>var_per_installment</name></var>
</message>


<message>
<name>withdrawal_allowed</name>
<note>allowed withdrawal</note>
<var><type>double</type><name>withdrawal_allowed</name></var>
<var><type>int</type><name>household_id</name></var>
</message>

<message>
<name>bankruptcy</name>
<note></note>
<var><type>int</type><name>bank_id</name></var>
<var><type>double</type><name>bad_debt</name></var>
<var><type>double</type><name>credit_refunded</name></var>
<var><type>double</type><name>residual_var</name></var>
</message>


</messages>


</xmachine_agent_model>
