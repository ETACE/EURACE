<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE xmodel SYSTEM "../dtd/XMML.dtd">
<xmodel version="2">

<name>Credit_Market</name>
<version>pre-Genoa</version>
<description></description>

<environment>

<functionFiles>
<file>Bank_Credit_Functions.c</file>
<file>Firm_Credit_Functions.c</file>
</functionFiles>

</environment>

<agents>

<xagent>
<name>Firm</name>
<memory>
</memory>
<functions>

<function>
<name>Firm_apply_for_loans</name>
<current_state>20</current_state>
<next_state>21</next_state>
<condition>Firm_is_external_financial_needs</condition>
<output><messagetype>loan_request</messagetype></output>
</function>

<function>
<name>Firm_read_loan_offers_send_loan_acceptance</name>
<current_state>21</current_state>
<next_state>22</next_state>
<input><messagetype>loan_conditions</messagetype></input>
<output><messagetype>loan_acceptance</messagetype></output>
</function>

<function>
<name>Firm_idle</name>
<current_state>22</current_state>
<next_state>27</next_state>
<condition>Firm_no_external_financial_needs</condition>
</function>

</functions>
</xagent>

<xagent>
<name>Bank</name>
<memory>
<variable><type>double</type><name>account[10]</name></variable>
<variable><type>double</type><name>proposed_interest_rate</name></variable>
<variable><type>double</type><name>amount_credit_offer</name></variable>
</memory>
<functions>


<function>
<name>Bank_read_interest_payments</name>
<current_state>start_Bank</current_state>
<next_state>01</next_state>
<input><messagetype>interest_payment</messagetype></input>
</function>

<function>
<name>Bank_read_debt_installment_payments</name>
<current_state>01</current_state>
<next_state>02</next_state>
<input><messagetype>debt_installment_payment</messagetype></input>
</function>

<function>
<name>Bank_read_loan_request_send_offers</name>
<current_state>02</current_state>
<next_state>03</next_state>
<input><messagetype>loan_request</messagetype></input>
<output><messagetype>loan_conditions</messagetype></output>
</function>

<function>
<name>Bank_read_loan_acceptance</name>
<current_state>03</current_state>
<next_state>04</next_state>
<input><messagetype>loan_acceptance</messagetype></input>
</function>

</functions>
</xagent>

</agents>


<messages>

<message>
<name>loan_request</name>
<description>Added by firm to demand credit</description>
<variable><type>int</type><name>firm_id</name></variable>
<variable><type>int</type><name>bank_id</name></variable>
<variable><type>double</type><name>credit_amount</name></variable>
<variable><type>double</type><name>total_assets</name></variable>
<variable><type>double</type><name>total_debt</name></variable>
</message>

<message>
<name>loan_conditions</name>
<description>Added by bank to offer credit</description>
<variable><type>int</type><name>bank_id</name></variable>
<variable><type>int</type><name>firm_id</name></variable>
<variable><type>double</type><name>proposed_interest_rate</name></variable>
<variable><type>double</type><name>amount_credit_offer</name></variable>
</message>

<message>
<name>loan_acceptance</name>
<description>Added by firm to demand credit</description>
<variable><type>int</type><name>firm_id</name></variable>
<variable><type>int</type><name>bank_id</name></variable>
<variable><type>double</type><name>credit_amount_taken</name></variable>
</message>

<message>
<name>interest_payment</name>
<description>Added by firm to pay interest on debt</description>
<variable><type>int</type><name>firm_id</name></variable>
<variable><type>int</type><name>bank_id</name></variable>
<variable><type>double</type><name>interest_payment</name></variable>
</message>

<message>
<name>debt_installment_payment</name>
<description>Added by firm to pay debt installments</description>
<variable><type>int</type><name>firm_id</name></variable>
<variable><type>int</type><name>bank_id</name></variable>
<variable><type>double</type><name>debt_installment_payment</name></variable>
</message>

</messages>


</xmodel>
