<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE xmodel SYSTEM "../dtd/XMML.dtd">
<xmodel version="2">

<name>Financial_Market</name>
<author>Eurace</author>
<date></date>

<environment>

<functionFiles>
<file>Firm_Financial_Functions.c</file>
<file>Household_Financial_Functions.c</file>
<file>Clearinghouse_Financial_Functions.c</file>
<file>Government_Financial_Functions.c</file>
</functionFiles>

</environment>

<agents>

<xagent>
<name>Firm</name>
<memory>
<!----------------- Financial variables ---------------------------------------->
<variable><type>double</type><name>current_share_price</name></variable>
<variable><type>double</type><name>current_shares_outstanding</name></variable>
<variable><type>double</type><name>previous_dividend_per_share</name></variable>
<variable><type>double</type><name>current_dividend_per_share</name></variable>
<variable><type>double</type><name>previous_dividend_per_earnings</name></variable>
<variable><type>double</type><name>current_dividend_per_earnings</name></variable>

<!----------------- Ratios ---------------------------------------->
<variable><type>double</type><name>earnings_per_share_ratio</name></variable>
<variable><type>double</type><name>debt_earnings_ratio</name></variable>
<variable><type>double</type><name>price_earnings_ratio</name></variable>
<variable><type>double</type><name>retained_earnings_ratio</name></variable>
<variable><type>double</type><name>earnings_per_share_ratio_growth</name></variable>
<variable><type>double</type><name>critical_price_earnings_ratio</name></variable>
<variable><type>double</type><name>critical_earnings_per_share_ratio</name></variable>

<!----------------- Misc variables (not yet used) ---------------------------------------->
<variable><type>double</type><name>target_loans</name></variable>
<variable><type>double</type><name>target_equity</name></variable>
<variable><type>double</type><name>bonds_issue_target</name></variable>
<variable><type>double</type><name>stocks_issue_target</name></variable>
</memory>
<functions>


<function>
<name>Firm_compute_and_send_bond_orders</name>
<current_state>22</current_state>
<next_state>23</next_state>
<condition>Firm_is_external_financial_needs</condition>
<output><messagetype>bond_order</messagetype></output>
</function>

<function>
<name>Firm_read_bond_transactions</name>
<current_state>23</current_state>
<next_state>24</next_state>
<input><messagetype>bond_transaction</messagetype></input>
</function>

<function>
<name>Firm_idle</name>
<current_state>24</current_state>
<next_state>27</next_state>
<condition>Firm_no_external_financial_needs</condition>
</function>

<function>
<name>Firm_compute_and_send_stock_orders</name>
<current_state>24</current_state>
<next_state>25</next_state>
<output><messagetype>stock_order</messagetype></output>
<condition>Firm_is_external_financial_needs</condition>
</function>

<function>
<name>Firm_read_stock_transactions</name>
<current_state>25</current_state>
<next_state>26</next_state>
<input><messagetype>stock_transaction</messagetype></input>
</function>

<!--  Firm role Consumption Goods market : Still to work out ------>



<!--  Firm role Labour market ------>

<!--Case 1: Firm_compute_payout_policy (external_financial_needs==0) -->
<function><name>Firm_idle</name>
<current_state>20</current_state>
<next_state>27</next_state>
<condition>Firm_no_external_financial_needs</condition>
</function>

<!--Case 2: Firm_compute_payout_policy (external_financial_needs==0) -->
<function><name>Firm_idle</name>
<current_state>26</current_state>
<next_state>27</next_state>
<condition>Firm_no_external_financial_needs</condition>
</function>

<!--Case 3: Firm_compute_payout_policy (external_financial_needs>0) -->
<function><name>Firm_calculate_specific_skills_and_wage_offer</name>
<current_state>27</current_state>
<next_state>28</next_state>
</function>

<function><name>Firm_send_capital_demand</name>
<current_state>10</current_state>
<next_state>11</next_state>
<output><messagetype>capital_good_request</messagetype></output>
</function>

<function><name>Firm_calc_pay_costs</name>
<current_state>11</current_state>
<next_state>12</next_state>
<input><messagetype>capital_good_delivery</messagetype></input>
<output><messagetype>wage_payment</messagetype></output>
<output><messagetype>pay_capital_goods</messagetype></output>
</function>


</functions>
</xagent>


<xagent>
<name>Household</name>
<memory>
<variable><type>double</type><name>expenditures</name></variable>
<variable><type>double</type><name>received_dividend_cap</name></variable>
<variable><type>double</type><name>received_dividend_cons</name></variable>
<variable><type>double</type><name>savings</name></variable>
<variable><type>double_array</type><name>last_income</name></variable>
<variable><type>int</type><name>day_of_month_receive_imcome</name></variable>
<variable><type>portfolio_array</type><name>household_portfolio</name></variable>
</memory>
<functions>

</functions>
</xagent>

<xagent>
<name>Clearinghouse</name>
<memory>
<variable><type>int</type><name>trader_id</name></variable>
<variable><type>int</type><name>stock_id</name></variable>
<variable><type>int</type><name>bond_id</name></variable>
<variable><type>int</type><name>gov_bond_id</name></variable>
<variable><type>double</type><name>limit_price</name></variable>
<variable><type>double</type><name>limit_quantity</name></variable>
<variable><type>double</type><name>transaction_price</name></variable>
<variable><type>double</type><name>transaction_quantity</name></variable>
</memory>
<functions>

<function>
<name>Clearinghouse_read_bond_orders</name>
<current_state>start_Clearinghouse</current_state>
<next_state>01</next_state>
<input><messagetype>bond_order</messagetype></input>
</function>

<function>
<name>Clearinghouse_compute_bond_transactions</name>
<current_state>01</current_state>
<next_state>02</next_state>
</function>

<function>
<name>Clearinghouse_send_bond_transactions</name>
<current_state>02</current_state>
<next_state>03</next_state>
<output><messagetype>bond_transaction</messagetype></output>
</function>

<function>
<name>Clearinghouse_read_stock_orders</name>
<current_state>03</current_state>
<next_state>04</next_state>
<input><messagetype>stock_order</messagetype></input>
</function>

<function>
<name>Clearinghouse_compute_stock_transactions</name>
<current_state>04</current_state>
<next_state>05</next_state>
</function>

<function>
<name>Clearinghouse_send_stock_transactions</name>
<current_state>05</current_state>
<next_state>end</next_state>
<output><messagetype>stock_transaction</messagetype></output>
</function>

</functions>
</xagent>

<xagent>
<name>Government</name>
<memory>
</memory>

<functions>
<function>
<name>Government_read_tax_payment</name>
<current_state>start_Government</current_state>
<next_state>end</next_state>
<input><messagetype>tax_payment</messagetype></input>
</function>
</functions>
</xagent>

</agents>

<messages>
<message>
<name>tax_payment</name>
<note>Added by firm to pay taxes</note>
<variable><type>int</type><name>firm_id</name></variable>
<variable><type>int</type><name>gov_id</name></variable>
<variable><type>double</type><name>tax_payment</name></variable>
</message>

<message>
<name>dividend_payment</name>
<note>Added by firm to pay dividends</note>
<variable><type>int</type><name>firm_id</name></variable>
<variable><type>double</type><name>current_dividend_per_share</name></variable>
</message>

<message>
<name>stock_order</name>
<note>Added by trader</note>
<variable><type>int</type><name>trader_id</name></variable>
<variable><type>int</type><name>stock_id</name></variable>
<variable><type>double</type><name>limit_price</name></variable>
<variable><type>double</type><name>limit_quantity</name></variable>
</message>

<message>
<name>stock_transaction</name>
<note>Added by clearinghouse</note>
<variable><type>int</type><name>trader_id</name></variable>
<variable><type>int</type><name>stock_id</name></variable>
<variable><type>double</type><name>transaction_price</name></variable>
<variable><type>double</type><name>transaction_quantity</name></variable>
</message>

<message>
<name>bond_order</name>
<note>Added by trader</note>
<variable><type>int</type><name>trader_id</name></variable>
<variable><type>int</type><name>bond_id</name></variable>
<variable><type>double</type><name>limit_price</name></variable>
<variable><type>double</type><name>limit_quantity</name></variable>
</message>

<message>
<name>bond_transaction</name>
<note>Added by clearinghouse</note>
<variable><type>int</type><name>trader_id</name></variable>
<variable><type>int</type><name>bond_id</name></variable>
<variable><type>double</type><name>transaction_price</name></variable>
<variable><type>double</type><name>transaction_quantity</name></variable>
</message>

<message>
<name>gov_bond_order</name>
<note>Added by trader</note>
<variable><type>int</type><name>trader_id</name></variable>
<variable><type>int</type><name>gov_bond_id</name></variable>
<variable><type>double</type><name>limit_price</name></variable>
<variable><type>double</type><name>limit_quantity</name></variable>
</message>

<message>
<name>gov_bond_transaction</name>
<note>Added by clearinghouse</note>
<variable><type>int</type><name>trader_id</name></variable>
<variable><type>int</type><name>gov_bond_id</name></variable>
<variable><type>double</type><name>transaction_price</name></variable>
<variable><type>double</type><name>transaction_quantity</name></variable>
</message>


</messages>


</xmodel>
